import{_ as I,a as f,u as P,F as U,r as u,o as g,c as y,b as t,d as o,w as s,e as h,t as _,f as D,B as C,p as T,g as F}from"./index.d10435ed.js";const b=C+"planification/",L=C+"company/direction/",N=C+"indicator/direction/",A={data(){return{planifications:null,planificationDialog:!1,deletePlanificationDialog:!1,deletePlanificationsDialog:!1,planification:{},company:{name:""},indicator:{name:""},selectedPlanifications:null,filters:{},submitted:!1,companies:[],indicators:[],autoFilteredIndicators:[],autoFilteredCompanies:[]}},created(){this.initFilters()},async mounted(){await this.loadData()},methods:{formatCurrency(n){if(n)return n.toLocaleString("en-US",{style:"currency",currency:"USD"})},openNew(){this.planification={},this.submitted=!1,this.planificationDialog=!0},hideDialog(){this.planificationDialog=!1,this.submitted=!1},async savePlanification(){const n=new Date;if(this.planification.date=n,this.submitted=!0,this.planification.id)this.planifications[this.findIndexById(this.planification.id)]=this.planification,this.$toast.add({severity:"success",summary:"Successful",detail:"Planificaci\xF3n modificada con \xE9xito",life:3e3});else try{await f.post(b,{...this.planification,company:this.company.id,indicator:this.indicator.id,direction:P().user.user.direction.id}),this.$toast.add({severity:"success",summary:"Successful",detail:"Planificaci\xF3n insertada con \xE9xito",life:3e3}),this.loadData()}catch(e){this.$toast.add({severity:"error",summary:"Error",detail:e,life:3e3}),console.log(e)}finally{this.planificationDialog=!1,this.planification={}}},editPlanification(n){this.planification={...n},this.planificationDialog=!0},confirmDeletePlanification(n){console.log("pase por ConfirmDeletePlanification"),this.planification=n,this.deletePlanificationDialog=!0},async deletePlanification(){console.log("pase por deletePlanification"),console.log(this.planification.id);const n=await f.delete(b+this.planification.id);console.log(n),this.deletePlanificationDialog=!1,this.planification={},this.$toast.add({severity:"success",summary:"Operaci\xF3n exitosa",detail:"Planificaci\xF3n eliminada",life:3e3})},findIndexById(n){let e=-1;for(let m=0;m<this.planifications.length;m++)if(this.planifications[m].id===n){e=m;break}return e},exportCSV(){this.$refs.dt.exportCSV()},confirmDeleteSelected(){console.log("pase por confirmDeleteSelected"),this.deletePlanificationsDialog=!0},async deleteSelectedPlanifications(){console.log("pase por ConfirmDeletePlanificatios"),await f.delete(b,this.planifications),this.deletePlanificationsDialog=!1,this.selectedPlanifications=null,this.$toast.add({severity:"success",summary:"Successful",detail:"Planifications Deleted",life:3e3})},initFilters(){this.filters={global:{value:null,matchMode:U.CONTAINS}}},loadData(){f.get(b).then(n=>{this.planifications=n.data}),f.get(`${L}${P().user.user.direction.id}`).then(n=>{this.companies=n.data}),f.get(`${N}${P().user.user.direction.id}`).then(n=>{this.indicators=n.data})},searchIndicator(n){setTimeout(()=>{n.query.trim().length?this.autoFilteredIndicators=this.indicators.filter(e=>e.name.toLowerCase().startsWith(n.query.toLowerCase())):this.autoFilteredIndicators=[...this.indicators]},250)},searchCompanies(n){setTimeout(()=>{n.query.trim().length?this.autoFilteredCompanies=this.companies.filter(e=>e.name.toLowerCase().startsWith(n.query.toLowerCase())):this.autoFilteredCompanies=[...this.companies]},250)}}},a=n=>(T("data-v-a51b32d7"),n=n(),F(),n),B={class:"grid"},j={class:"col-12"},E={class:"card"},M={class:"my-2"},R={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},q=a(()=>t("h5",{class:"m-0"},"Planificaci\xF3n anual",-1)),O={class:"block mt-2 md:mt-0 p-input-icon-left"},z=a(()=>t("i",{class:"pi pi-search"},null,-1)),J=a(()=>t("span",{class:"p-column-title"},"Indicador",-1)),W=a(()=>t("span",{class:"p-column-title"},"Empresa",-1)),G=a(()=>t("span",{class:"p-column-title"},"Direcci\xF3n",-1)),K=a(()=>t("span",{class:"p-column-title"},"A\xF1o",-1)),Y={class:"field"},H=a(()=>t("label",{for:"companyId",class:"mb-3"},"Empresa",-1)),Q={class:"field"},X=a(()=>t("label",{for:"indicatorId",class:"mb-3"},"Tipo de indicador",-1)),Z={class:"formgrid grid"},$={class:"field col"},ee=a(()=>t("label",{for:"name2"},"Enero",-1)),ie={class:"field col"},te=a(()=>t("label",{for:"email2"},"Febrero",-1)),le={class:"formgrid grid"},oe={class:"field col"},ne=a(()=>t("label",{for:"name2"},"Marzo",-1)),ae={class:"field col"},se=a(()=>t("label",{for:"email2"},"Abril",-1)),de={class:"formgrid grid"},ce={class:"field col"},re=a(()=>t("label",{for:"name2"},"Mayo",-1)),ue={class:"field col"},me=a(()=>t("label",{for:"email2"},"Junio",-1)),pe={class:"formgrid grid"},fe={class:"field col"},he=a(()=>t("label",{for:"name2"},"Julio",-1)),_e={class:"field col"},be=a(()=>t("label",{for:"email2"},"Agosto",-1)),ge={class:"formgrid grid"},ye={class:"field col"},ve=a(()=>t("label",{for:"name2"},"Septiembre",-1)),Pe={class:"field col"},Ce=a(()=>t("label",{for:"email2"},"Octubre",-1)),Ve={class:"formgrid grid"},De={class:"field col"},we=a(()=>t("label",{for:"name2"},"Noviembre",-1)),xe={class:"field col"},ke=a(()=>t("label",{for:"email2"},"Diciembre",-1)),Se={class:"flex align-items-center justify-content-center"},Ie=a(()=>t("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1)),Ue={key:0},Te={class:"flex align-items-center justify-content-center"},Fe=a(()=>t("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1)),Le={key:0};function Ne(n,e,m,Be,l,r){const w=u("Toast"),c=u("Button"),x=u("Toolbar"),d=u("InputText"),p=u("Column"),k=u("DataTable"),V=u("AutoComplete"),v=u("Dialog");return g(),y("div",B,[t("div",j,[t("div",E,[o(w),o(x,{class:"mb-4"},{start:s(()=>[t("div",M,[o(c,{label:"A\xF1adir",icon:"pi pi-plus",class:"p-button-success mr-2",onClick:r.openNew},null,8,["onClick"]),o(c,{label:"Eliminar",icon:"pi pi-trash",class:"p-button-danger",onClick:r.confirmDeleteSelected,disabled:!l.selectedPlanifications||!l.selectedPlanifications.length},null,8,["onClick","disabled"])])]),_:1}),o(k,{ref:"dt",value:l.planifications,selection:l.selectedPlanifications,"onUpdate:selection":e[1]||(e[1]=i=>l.selectedPlanifications=i),dataKey:"id",paginator:!0,rows:10,filters:l.filters,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"Mostrando {first} hasta {last} de {totalRecords} tipos de indicadores",responsiveLayout:"scroll"},{header:s(()=>[t("div",R,[q,t("span",O,[z,o(d,{modelValue:l.filters.global.value,"onUpdate:modelValue":e[0]||(e[0]=i=>l.filters.global.value=i),placeholder:"Buscar..."},null,8,["modelValue"])])])]),default:s(()=>[o(p,{selectionMode:"multiple",headerStyle:"width: 3rem"}),o(p,{field:"name",header:"Indicador",sortable:!0,headerStyle:"width:14%; min-width:10rem;"},{body:s(i=>[J,h(" "+_(i.data.indicator.name),1)]),_:1}),o(p,{field:"name",header:"Empresa",sortable:!0,headerStyle:"width:14%; min-width:10rem;"},{body:s(i=>[W,h(" "+_(i.data.company.name),1)]),_:1}),o(p,{field:"name",header:"Direcci\xF3n",sortable:!0,headerStyle:"width:14%; min-width:10rem;"},{body:s(i=>[G,h(" "+_(i.data.direction.name),1)]),_:1}),o(p,{field:"name",header:"Fecha entrada",sortable:!0,headerStyle:"width:14%; min-width:10rem;"},{body:s(i=>[K,h(" "+_(i.data.date),1)]),_:1}),o(p,{headerStyle:"min-width:10rem;"},{body:s(i=>[o(c,{icon:"pi pi-pencil",class:"p-button-rounded p-button-success mr-2",onClick:S=>r.editPlanification(i.data)},null,8,["onClick"]),o(c,{icon:"pi pi-trash",class:"p-button-rounded p-button-warning mt-2",onClick:S=>r.confirmDeletePlanification(i.data)},null,8,["onClick"])]),_:1})]),_:1},8,["value","selection","filters"]),o(v,{visible:l.planificationDialog,"onUpdate:visible":e[18]||(e[18]=i=>l.planificationDialog=i),style:{width:"450px"},header:"Planificacaci\xF3n anual",modal:!0,class:"p-fluid"},{footer:s(()=>[o(c,{label:"Cancelar",icon:"pi pi-times",class:"p-button-text",onClick:r.hideDialog},null,8,["onClick"]),o(c,{label:"Guardar",icon:"pi pi-check",class:"p-button-text",onClick:r.savePlanification},null,8,["onClick"])]),default:s(()=>[t("div",Y,[H,o(V,{placeholder:"Buscar Compa\xF1ia",id:"companyId",dropdown:!0,modelValue:l.company,"onUpdate:modelValue":e[2]||(e[2]=i=>l.company=i),suggestions:l.autoFilteredCompanies,onComplete:e[3]||(e[3]=i=>r.searchCompanies(i)),"force-selection":!0,field:"name"},null,8,["modelValue","suggestions"])]),t("div",Q,[X,o(V,{placeholder:"Buscar indicador",id:"indicatorId",dropdown:!0,modelValue:l.indicator,"onUpdate:modelValue":e[4]||(e[4]=i=>l.indicator=i),suggestions:l.autoFilteredIndicators,onComplete:e[5]||(e[5]=i=>r.searchIndicator(i)),"force-selection":!0,field:"name"},null,8,["modelValue","suggestions"])]),t("div",Z,[t("div",$,[ee,o(d,{id:"name2",type:"number",modelValue:l.planification.january,"onUpdate:modelValue":e[6]||(e[6]=i=>l.planification.january=i)},null,8,["modelValue"])]),t("div",ie,[te,o(d,{id:"email2",type:"number",modelValue:l.planification.february,"onUpdate:modelValue":e[7]||(e[7]=i=>l.planification.february=i)},null,8,["modelValue"])])]),t("div",le,[t("div",oe,[ne,o(d,{id:"name2",type:"number",modelValue:l.planification.march,"onUpdate:modelValue":e[8]||(e[8]=i=>l.planification.march=i)},null,8,["modelValue"])]),t("div",ae,[se,o(d,{id:"email2",type:"number",modelValue:l.planification.april,"onUpdate:modelValue":e[9]||(e[9]=i=>l.planification.april=i)},null,8,["modelValue"])])]),t("div",de,[t("div",ce,[re,o(d,{id:"name2",type:"number",modelValue:l.planification.may,"onUpdate:modelValue":e[10]||(e[10]=i=>l.planification.may=i)},null,8,["modelValue"])]),t("div",ue,[me,o(d,{id:"email2",type:"number",modelValue:l.planification.june,"onUpdate:modelValue":e[11]||(e[11]=i=>l.planification.june=i)},null,8,["modelValue"])])]),t("div",pe,[t("div",fe,[he,o(d,{id:"name2",type:"number",modelValue:l.planification.july,"onUpdate:modelValue":e[12]||(e[12]=i=>l.planification.july=i)},null,8,["modelValue"])]),t("div",_e,[be,o(d,{id:"email2",type:"number",modelValue:l.planification.august,"onUpdate:modelValue":e[13]||(e[13]=i=>l.planification.august=i)},null,8,["modelValue"])])]),t("div",ge,[t("div",ye,[ve,o(d,{id:"name2",type:"number",modelValue:l.planification.september,"onUpdate:modelValue":e[14]||(e[14]=i=>l.planification.september=i)},null,8,["modelValue"])]),t("div",Pe,[Ce,o(d,{id:"email2",type:"number",modelValue:l.planification.october,"onUpdate:modelValue":e[15]||(e[15]=i=>l.planification.october=i)},null,8,["modelValue"])])]),t("div",Ve,[t("div",De,[we,o(d,{id:"name2",type:"number",modelValue:l.planification.november,"onUpdate:modelValue":e[16]||(e[16]=i=>l.planification.november=i)},null,8,["modelValue"])]),t("div",xe,[ke,o(d,{id:"email2",type:"number",modelValue:l.planification.december,"onUpdate:modelValue":e[17]||(e[17]=i=>l.planification.december=i)},null,8,["modelValue"])])])]),_:1},8,["visible"]),o(v,{visible:l.deletePlanificationDialog,"onUpdate:visible":e[20]||(e[20]=i=>l.deletePlanificationDialog=i),style:{width:"450px"},header:"Confirmar",modal:!0},{footer:s(()=>[o(c,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:e[19]||(e[19]=i=>l.deletePlanificationDialog=!1)}),o(c,{label:"Si",icon:"pi pi-check",class:"p-button-text",onClick:r.deletePlanification},null,8,["onClick"])]),default:s(()=>[t("div",Se,[Ie,l.planification?(g(),y("span",Ue,[h("\xBFSeguro que desea eliminar "),t("b",null,_(l.planification.name),1),h("?")])):D("",!0)])]),_:1},8,["visible"]),o(v,{visible:l.deletePlanificationsDialog,"onUpdate:visible":e[22]||(e[22]=i=>l.deletePlanificationsDialog=i),style:{width:"450px"},header:"Confirm",modal:!0},{footer:s(()=>[o(c,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:e[21]||(e[21]=i=>l.deletePlanificationsDialog=!1)}),o(c,{label:"Si",icon:"pi pi-check",class:"p-button-text",onClick:n.deleteSelectedPlanification},null,8,["onClick"])]),default:s(()=>[t("div",Te,[Fe,l.planification?(g(),y("span",Le,"\xBFSeguro que desea eliminar las planificaciones seleccionadas?")):D("",!0)])]),_:1},8,["visible"])])])])}const Ae=I(A,[["render",Ne],["__scopeId","data-v-a51b32d7"]]),Ee={__name:"Planification",setup(n){return(e,m)=>(g(),y("main",null,[o(Ae)]))}};export{Ee as default};
