import{_ as N,a as u,F as V,r as d,o as h,c as f,b as n,d as o,w as l,e as b,t as C,n as L,f as y,B as I,p as U,g as M}from"./index.d10435ed.js";const p=I+"indicator/",F=I+"direction/",P=I+"measurementunit/",B={data(){return{indicators:null,indicatorDialog:!1,deleteIndicatorDialog:!1,deleteIndicatorsDialog:!1,indicator:{},selectedIndicators:null,filters:{},submitted:!1,measurementunits:[],directions:[],direction:{name:""},measurementunit:{name:""},autoFilteredMeasurementunits:[],autoFilteredDirections:[]}},created(){this.initFilters()},async mounted(){this.loadData()},methods:{formatCurrency(e){if(e)return e.toLocaleString("en-US",{style:"currency",currency:"USD"})},openNew(){this.indicator={},this.submitted=!1,this.indicatorDialog=!0},hideDialog(){this.indicatorDialog=!1,this.submitted=!1},async saveIndicator(){if(this.submitted=!0,this.indicator.name.trim())if(this.indicator.id){this.indicator;try{await u.patch(p+this.indicator.id,{...this.indicator,measurementunit:this.measurementunit.id}),this.$toast.add({severity:"success",summary:"Successful",detail:"Tipo de indicador modificado con \xE9xito",life:3e3}),this.loadData()}catch(e){this.$toast.add({severity:"error",summary:"Error",detail:e,life:3e3}),console.log(e)}finally{this.indicatorDialog=!1,this.indicator={}}}else try{await u.post(p,{...this.indicator,measurementunit:this.measurementunit.id,direction:this.direction.id}),this.$toast.add({severity:"success",summary:"Successful",detail:"Tipo de indicador insertada con \xE9xito",life:3e3}),this.loadData()}catch(e){this.$toast.add({severity:"error",summary:"Error",detail:e,life:3e3}),console.log(e)}finally{this.indicatorDialog=!1,this.indicator={}}},editIndicator(e){this.indicator={...e},this.indicatorDialog=!0},confirmDeleteIndicator(e){console.log("pase por ConfirmDeleteIndicator"),this.indicator=e,this.deleteIndicatorDialog=!0},async deleteIndicator(){console.log("pase por deleteIndicator"),console.log(this.indicator.id);const e=await u.delete(p+this.indicator.id);console.log(e),this.deleteIndicatorDialog=!1,this.indicator={},this.$toast.add({severity:"success",summary:"Operaci\xF3n exitosa",detail:"Tipo de indicador eliminado",life:3e3})},findIndexById(e){let t=-1;for(let m=0;m<this.indicators.length;m++)if(this.indicators[m].id===e){t=m;break}return t},exportCSV(){this.$refs.dt.exportCSV()},confirmDeleteSelected(){console.log("pase por confirmDeleteSelected"),this.deleteIndicatorsDialog=!0},async deleteSelectedIndicators(){console.log("pase por ConfirmDeleteIndicators"),await u.delete(p,this.indicators),this.deleteIndicatorsDialog=!1,this.selectedIndicators=null,this.$toast.add({severity:"success",summary:"Successful",detail:"Indicators Deleted",life:3e3})},initFilters(){this.filters={global:{value:null,matchMode:V.CONTAINS}}},loadData(){u.get(p).then(e=>{this.indicators=e.data}),u.get(F).then(e=>{this.directions=e.data}),u.get(P).then(e=>{this.measurementunits=e.data})},searchMeasurementunits(e){setTimeout(()=>{e.query.trim().length?this.autoFilteredMeasurementunits=this.measurementunits.filter(t=>t.name.toLowerCase().startsWith(e.query.toLowerCase())):this.autoFilteredMeasurementunits=[...this.measurementunits]},250)},searchDirections(e){setTimeout(()=>{e.query.trim().length?this.autoFilteredDirections=this.directions.filter(t=>t.name.toLowerCase().startsWith(e.query.toLowerCase())):this.autoFilteredDirections=[...this.directions]},250)}}},c=e=>(U("data-v-963255e8"),e=e(),M(),e),q={class:"grid"},E={class:"col-12"},R={class:"card"},A={class:"my-2"},O={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},j=c(()=>n("h5",{class:"m-0"},"Listado de tipos de indicadores",-1)),z={class:"block mt-2 md:mt-0 p-input-icon-left"},W=c(()=>n("i",{class:"pi pi-search"},null,-1)),G=c(()=>n("span",{class:"p-column-title"},"Nombre",-1)),K={class:"field"},H=c(()=>n("label",{for:"name"},"Nombre",-1)),J={key:0,class:"p-invalid"},Q={class:"field"},X=c(()=>n("label",{for:"description"},"Descripci\xF3n",-1)),Y={class:"field"},Z=c(()=>n("label",{for:"measurementunitId",class:"mb-3"},"Unidad de medida",-1)),$={class:"flex align-items-center justify-content-center"},ee=c(()=>n("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1)),te={key:0},ie={class:"flex align-items-center justify-content-center"},se=c(()=>n("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1)),oe={key:0};function ne(e,t,m,ae,i,r){const v=d("Toast"),a=d("Button"),x=d("Toolbar"),D=d("InputText"),_=d("Column"),k=d("DataTable"),w=d("Textarea"),S=d("AutoComplete"),g=d("Dialog");return h(),f("div",q,[n("div",E,[n("div",R,[o(v),o(x,{class:"mb-4"},{start:l(()=>[n("div",A,[o(a,{label:"A\xF1adir",icon:"pi pi-plus",class:"p-button-success mr-2",onClick:r.openNew},null,8,["onClick"]),o(a,{label:"Eliminar",icon:"pi pi-trash",class:"p-button-danger",onClick:r.confirmDeleteSelected,disabled:!i.selectedIndicators||!i.selectedIndicators.length},null,8,["onClick","disabled"])])]),_:1}),o(k,{ref:"dt",value:i.indicators,selection:i.selectedIndicators,"onUpdate:selection":t[1]||(t[1]=s=>i.selectedIndicators=s),dataKey:"id",paginator:!0,rows:10,filters:i.filters,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"Mostrando {first} hasta {last} de {totalRecords} tipos de indicadores",responsiveLayout:"scroll"},{header:l(()=>[n("div",O,[j,n("span",z,[W,o(D,{modelValue:i.filters.global.value,"onUpdate:modelValue":t[0]||(t[0]=s=>i.filters.global.value=s),placeholder:"Buscar..."},null,8,["modelValue"])])])]),default:l(()=>[o(_,{selectionMode:"multiple",headerStyle:"width: 3rem"}),o(_,{field:"name",header:"Nombre",sortable:!0,headerStyle:"width:14%; min-width:10rem;"},{body:l(s=>[G,b(" "+C(s.data.name),1)]),_:1}),o(_,{headerStyle:"min-width:10rem;"},{body:l(s=>[o(a,{icon:"pi pi-pencil",class:"p-button-rounded p-button-success mr-2",onClick:T=>r.editIndicator(s.data)},null,8,["onClick"]),o(a,{icon:"pi pi-trash",class:"p-button-rounded p-button-warning mt-2",onClick:T=>r.confirmDeleteIndicator(s.data)},null,8,["onClick"])]),_:1})]),_:1},8,["value","selection","filters"]),o(g,{visible:i.indicatorDialog,"onUpdate:visible":t[6]||(t[6]=s=>i.indicatorDialog=s),style:{width:"450px"},header:"Detalles Tipo de indicador",modal:!0,class:"p-fluid"},{footer:l(()=>[o(a,{label:"Cancelar",icon:"pi pi-times",class:"p-button-text",onClick:r.hideDialog},null,8,["onClick"]),o(a,{label:"Guardar",icon:"pi pi-check",class:"p-button-text",onClick:r.saveIndicator},null,8,["onClick"])]),default:l(()=>[n("div",K,[H,o(D,{id:"name",modelValue:i.indicator.name,"onUpdate:modelValue":t[2]||(t[2]=s=>i.indicator.name=s),modelModifiers:{trim:!0},required:"true",autofocus:"",class:L({"p-invalid":i.submitted&&!i.indicator.name})},null,8,["modelValue","class"]),i.submitted&&!i.indicator.name?(h(),f("small",J,"Nombre es requerido.")):y("",!0)]),n("div",Q,[X,o(w,{id:"description",modelValue:i.indicator.description,"onUpdate:modelValue":t[3]||(t[3]=s=>i.indicator.description=s),required:"true",rows:"3",cols:"20"},null,8,["modelValue"])]),n("div",Y,[Z,o(S,{placeholder:"Buscar unidad de medida",id:"measurementunitId",dropdown:!0,modelValue:i.measurementunit,"onUpdate:modelValue":t[4]||(t[4]=s=>i.measurementunit=s),suggestions:i.autoFilteredMeasurementunits,onComplete:t[5]||(t[5]=s=>r.searchMeasurementunits(s)),"force-selection":!0,field:"name"},null,8,["modelValue","suggestions"])])]),_:1},8,["visible"]),o(g,{visible:i.deleteIndicatorDialog,"onUpdate:visible":t[8]||(t[8]=s=>i.deleteIndicatorDialog=s),style:{width:"450px"},header:"Confirmar",modal:!0},{footer:l(()=>[o(a,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:t[7]||(t[7]=s=>i.deleteIndicatorDialog=!1)}),o(a,{label:"Si",icon:"pi pi-check",class:"p-button-text",onClick:r.deleteIndicator},null,8,["onClick"])]),default:l(()=>[n("div",$,[ee,i.indicator?(h(),f("span",te,[b("\xBFSeguro que desea eliminar "),n("b",null,C(i.indicator.name),1),b("?")])):y("",!0)])]),_:1},8,["visible"]),o(g,{visible:i.deleteIndicatorsDialog,"onUpdate:visible":t[10]||(t[10]=s=>i.deleteIndicatorsDialog=s),style:{width:"450px"},header:"Confirm",modal:!0},{footer:l(()=>[o(a,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:t[9]||(t[9]=s=>i.deleteIndicatorsDialog=!1)}),o(a,{label:"Si",icon:"pi pi-check",class:"p-button-text",onClick:r.deleteSelectedIndicators},null,8,["onClick"])]),default:l(()=>[n("div",ie,[se,i.indicator?(h(),f("span",oe,"\xBFSeguro que desea eliminar las tipos de indicadores seleccionadas?")):y("",!0)])]),_:1},8,["visible"])])])])}const le=N(B,[["render",ne],["__scopeId","data-v-963255e8"]]),de={__name:"Indicators",setup(e){return(t,m)=>(h(),f("main",null,[o(le)]))}};export{de as default};
