import{_ as I,a as _,F as R,r as u,o as c,c as m,b as o,d as i,w as r,e as h,t as b,n as v,f as g,B as D,p as T,g as L}from"./index.d10435ed.js";const C=D+"security/users/",N=D+"direction/",q=D+"security/",E=D+"security/register/",F={data(){return{users:null,userDialog:!1,deleteUserDialog:!1,deleteUsersDialog:!1,user:{},rol:{name:""},direction:{name:""},selectedUsers:null,filters:{},submitted:!1,directions:[],direction:{name:""},autoFilteredDirections:[],roles:[{name:"Especialista",value:"especialista"},{name:"Director",value:"director"}]}},created(){this.initFilters()},async mounted(){this.loadData()},methods:{formatCurrency(l){if(l)return l.toLocaleString("en-US",{style:"currency",currency:"USD"})},openNew(){this.user={},this.submitted=!1,this.userDialog=!0},hideDialog(){this.userDialog=!1,this.submitted=!1},async saveUser(){if(this.submitted=!0,this.user.name.trim())if(this.user.id){this.user;try{await _.patch(C+this.user.id,{...this.user}),this.$toast.add({severity:"success",summary:"Successful",detail:"Usuario modificado con \xE9xito",life:3e3}),this.loadData()}catch(l){this.$toast.add({severity:"error",summary:"Error",detail:l,life:3e3}),console.log(l)}finally{this.userDialog=!1,this.user={}}}else try{console.log(this.direction.id),console.log(this.rol.value),await _.post(E,{...this.user,direction:this.direction.id,role:this.rol.value}),this.$toast.add({severity:"success",summary:"Successful",detail:"Usuario insertado con \xE9xito",life:3e3}),this.loadData()}catch(l){this.$toast.add({severity:"error",summary:"Error",detail:l,life:3e3}),console.log(l)}finally{this.userDialog=!1,this.user={}}},editUser(l){this.user={...l},this.userDialog=!0},confirmDeleteUser(l){console.log("pase por ConfirmDeleteUser"),this.user=l,this.deleteUserDialog=!0},async deleteUser(){console.log("pase por deleteUser"),console.log(this.user.id);const l=await _.delete(q+this.user.id);console.log(l),this.loadData(),this.deleteUserDialog=!1,this.user={},this.$toast.add({severity:"success",summary:"Operaci\xF3n exitosa",detail:"Usuario eliminado",life:3e3})},findIndexById(l){let t=-1;for(let f=0;f<this.users.length;f++)if(this.users[f].id===l){t=f;break}return t},exportCSV(){this.$refs.dt.exportCSV()},confirmDeleteSelected(){console.log("pase por confirmDeleteSelected"),this.deleteUsersDialog=!0},async deleteSelectedUsers(){console.log("pase por ConfirmDeleteUsers"),await _.delete(C,this.users),this.deleteUsersDialog=!1,this.loadData(),this.selectedUsers=null,this.$toast.add({severity:"success",summary:"Successful",detail:"Users Deleted",life:3e3})},initFilters(){this.filters={global:{value:null,matchMode:R.CONTAINS}}},loadData(){_.get(C).then(l=>{this.users=l.data}),_.get(N).then(l=>{this.directions=l.data})},searchDirections(l){setTimeout(()=>{l.query.trim().length?this.autoFilteredDirections=this.directions.filter(t=>t.name.toLowerCase().startsWith(l.query.toLowerCase())):this.autoFilteredDirections=[...this.directions]},250)},searchRoles(l){setTimeout(()=>{l.query.trim().length?this.autoFilteredRoles=this.roles.filter(t=>t.name.toLowerCase().startsWith(l.query.toLowerCase())):this.autoFilteredRoles=[...this.roles]},250)}}},n=l=>(T("data-v-5d2d7d52"),l=l(),L(),l),P={class:"grid"},B={class:"col-12"},A={class:"card"},M={class:"my-2"},O={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},j=n(()=>o("h5",{class:"m-0"},"Listado de usuarios",-1)),z={class:"block mt-2 md:mt-0 p-input-icon-left"},G=n(()=>o("i",{class:"pi pi-search"},null,-1)),W=n(()=>o("span",{class:"p-column-title"},"Nombre",-1)),K=n(()=>o("span",{class:"p-column-title"},"Apellidos",-1)),H=n(()=>o("span",{class:"p-column-title"},"Correo",-1)),J=n(()=>o("span",{class:"p-column-title"},"Rol",-1)),Q=n(()=>o("span",{class:"p-column-title"},"Direcci\xF3n",-1)),X={class:"field"},Y=n(()=>o("label",{for:"name"},"Nombre",-1)),Z={key:0,class:"p-invalid"},$={class:"field"},ee=n(()=>o("label",{for:"lastname"},"Apellidos",-1)),se={key:0,class:"p-invalid"},te={class:"field"},le=n(()=>o("label",{for:"email"},"Correo",-1)),ie={key:0,class:"p-invalid"},oe={class:"field"},re=n(()=>o("label",{for:"password"},"Contrase\xF1a",-1)),ne={key:0,class:"p-invalid"},ae={class:"field"},de=n(()=>o("label",{for:"roleId",class:"mb-3"},"Rol",-1)),ue={class:"field"},ce=n(()=>o("label",{for:"directionId",class:"mb-3"},"Direcci\xF3n",-1)),me={class:"flex align-items-center justify-content-center"},pe=n(()=>o("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1)),he={key:0},fe={class:"flex align-items-center justify-content-center"},_e=n(()=>o("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1)),be={key:0};function ge(l,t,f,ve,e,a){const k=u("Toast"),d=u("Button"),x=u("Toolbar"),y=u("InputText"),p=u("Column"),S=u("DataTable"),w=u("AutoComplete"),U=u("Dialog");return c(),m("div",P,[o("div",B,[o("div",A,[i(k),i(x,{class:"mb-4"},{start:r(()=>[o("div",M,[i(d,{label:"A\xF1adir",icon:"pi pi-plus",class:"p-button-success mr-2",onClick:a.openNew},null,8,["onClick"]),i(d,{label:"Eliminar",icon:"pi pi-trash",class:"p-button-danger",onClick:a.confirmDeleteSelected,disabled:!e.selectedUsers||!e.selectedUsers.length},null,8,["onClick","disabled"])])]),_:1}),i(S,{ref:"dt",value:e.users,selection:e.selectedUsers,"onUpdate:selection":t[1]||(t[1]=s=>e.selectedUsers=s),dataKey:"id",paginator:!0,rows:10,filters:e.filters,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"Mostrando {first} hasta {last} de {totalRecords} tipos de indicadores",responsiveLayout:"scroll"},{header:r(()=>[o("div",O,[j,o("span",z,[G,i(y,{modelValue:e.filters.global.value,"onUpdate:modelValue":t[0]||(t[0]=s=>e.filters.global.value=s),placeholder:"Buscar..."},null,8,["modelValue"])])])]),default:r(()=>[i(p,{selectionMode:"multiple",headerStyle:"width: 3rem"}),i(p,{field:"name",header:"Nombre",sortable:!0,headerStyle:"width:14%; min-width:10rem;"},{body:r(s=>[W,h(" "+b(s.data.name),1)]),_:1}),i(p,{field:"lastname",header:"Apellidos",sortable:!0,headerStyle:"width:14%; min-width:10rem;"},{body:r(s=>[K,h(" "+b(s.data.lastname),1)]),_:1}),i(p,{field:"email",header:"Correo",sortable:!0,headerStyle:"width:14%; min-width:10rem;"},{body:r(s=>[H,h(" "+b(s.data.email),1)]),_:1}),i(p,{field:"role",header:"Rol",sortable:!0,headerStyle:"width:14%; min-width:10rem;"},{body:r(s=>[J,h(" "+b(s.data.role),1)]),_:1}),i(p,{field:"direction",header:"Direcci\xF3n",sortable:!0,headerStyle:"width:14%; min-width:10rem;"},{body:r(s=>[Q,h(" "+b(s.data.direction),1)]),_:1}),i(p,{headerStyle:"min-width:10rem;"},{body:r(s=>[i(d,{icon:"pi pi-pencil",class:"p-button-rounded p-button-success mr-2",onClick:V=>a.editUser(s.data)},null,8,["onClick"]),i(d,{icon:"pi pi-trash",class:"p-button-rounded p-button-warning mt-2",onClick:V=>a.confirmDeleteUser(s.data)},null,8,["onClick"])]),_:1})]),_:1},8,["value","selection","filters"]),i(U,{visible:e.userDialog,"onUpdate:visible":t[10]||(t[10]=s=>e.userDialog=s),style:{width:"450px"},header:"Inserte los datos del usuario",modal:!0,class:"p-fluid"},{footer:r(()=>[i(d,{label:"Cancelar",icon:"pi pi-times",class:"p-button-text",onClick:a.hideDialog},null,8,["onClick"]),i(d,{label:"Guardar",icon:"pi pi-check",class:"p-button-text",onClick:a.saveUser},null,8,["onClick"])]),default:r(()=>[o("div",X,[Y,i(y,{id:"name",modelValue:e.user.name,"onUpdate:modelValue":t[2]||(t[2]=s=>e.user.name=s),modelModifiers:{trim:!0},required:"true",autofocus:"",class:v({"p-invalid":e.submitted&&!e.user.name})},null,8,["modelValue","class"]),e.submitted&&!e.user.name?(c(),m("small",Z,"Nombre es requerido.")):g("",!0)]),o("div",$,[ee,i(y,{id:"lastname",modelValue:e.user.lastname,"onUpdate:modelValue":t[3]||(t[3]=s=>e.user.lastname=s),modelModifiers:{trim:!0},required:"true",autofocus:"",class:v({"p-invalid":e.submitted&&!e.user.lastname})},null,8,["modelValue","class"]),e.submitted&&!e.user.name?(c(),m("small",se,"Apellidos es requerido.")):g("",!0)]),o("div",te,[le,i(y,{id:"email",modelValue:e.user.email,"onUpdate:modelValue":t[4]||(t[4]=s=>e.user.email=s),modelModifiers:{trim:!0},required:"true",autofocus:"",class:v({"p-invalid":e.submitted&&!e.user.email})},null,8,["modelValue","class"]),e.submitted&&!e.user.email?(c(),m("small",ie,"Correo es requerido.")):g("",!0)]),o("div",oe,[re,i(y,{id:"password",modelValue:e.user.password,"onUpdate:modelValue":t[5]||(t[5]=s=>e.user.password=s),modelModifiers:{trim:!0},required:"true",autofocus:"",class:v({"p-invalid":e.submitted&&!e.user.password})},null,8,["modelValue","class"]),e.submitted&&!e.user.password?(c(),m("small",ne,"Contrase\xF1a es requerido.")):g("",!0)]),o("div",ae,[de,i(w,{placeholder:"Buscar rol",id:"rolId",dropdown:!0,modelValue:e.rol,"onUpdate:modelValue":t[6]||(t[6]=s=>e.rol=s),suggestions:l.autoFilteredRoles,onComplete:t[7]||(t[7]=s=>a.searchRoles(s)),"force-selection":!0,field:"name"},null,8,["modelValue","suggestions"])]),o("div",ue,[ce,i(w,{placeholder:"Buscar direcci\xF3n",id:"direcci\xF3nId",dropdown:!0,modelValue:e.direction,"onUpdate:modelValue":t[8]||(t[8]=s=>e.direction=s),suggestions:e.autoFilteredDirections,onComplete:t[9]||(t[9]=s=>a.searchDirections(s)),"force-selection":!0,field:"name"},null,8,["modelValue","suggestions"])])]),_:1},8,["visible"]),i(U,{visible:e.deleteUserDialog,"onUpdate:visible":t[12]||(t[12]=s=>e.deleteUserDialog=s),style:{width:"450px"},header:"Confirmar",modal:!0},{footer:r(()=>[i(d,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:t[11]||(t[11]=s=>e.deleteUserDialog=!1)}),i(d,{label:"Si",icon:"pi pi-check",class:"p-button-text",onClick:a.deleteUser},null,8,["onClick"])]),default:r(()=>[o("div",me,[pe,e.user?(c(),m("span",he,[h("\xBFSeguro que desea eliminar "),o("b",null,b(e.user.name),1),h("?")])):g("",!0)])]),_:1},8,["visible"]),i(U,{visible:e.deleteUsersDialog,"onUpdate:visible":t[14]||(t[14]=s=>e.deleteUsersDialog=s),style:{width:"450px"},header:"Confirm",modal:!0},{footer:r(()=>[i(d,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:t[13]||(t[13]=s=>e.deleteUsersDialog=!1)}),i(d,{label:"Si",icon:"pi pi-check",class:"p-button-text",onClick:a.deleteSelectedUsers},null,8,["onClick"])]),default:r(()=>[o("div",fe,[_e,e.user?(c(),m("span",be,"\xBFSeguro que desea eliminar las tipos de indicadores seleccionadas?")):g("",!0)])]),_:1},8,["visible"])])])])}const ye=I(F,[["render",ge],["__scopeId","data-v-5d2d7d52"]]),Ue={__name:"Users",setup(l){return(t,f)=>(c(),m("main",null,[i(ye)]))}};export{Ue as default};
