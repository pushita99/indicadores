import{_ as v,a as m,u as D,r as g,o as n,c as r,b as e,d,e as C,f as u,h as S,v as w,i as l,j as a,B as f,t as c}from"./index.d10435ed.js";const I=f+"reports/general_report/",b=f+"direction/",B={data(){return{sales:null,indicadores:[],autoFilteredDirections:[],directions:null,direction:null,loading:!0}},created(){},methods:{formatCurrency(t){return t.toLocaleString("en-US",{style:"currency",currency:"USD"})},async loadData(t){this.loading=!0;try{const s=await m.get(`${I}${t}`);this.indicadores=s.data,this.loading=!1}catch(s){console.log(s)}},async loadDirections(){try{const t=await m.get(b);this.directions=t.data}catch(t){console.log(t)}},getDirectionId(){return D().user.user.direction.id},searchDirections(t){setTimeout(()=>{t.query.trim().length?this.autoFilteredDirections=this.directions.filter(s=>s.name.toLowerCase().startsWith(t.query.toLowerCase())):this.autoFilteredDirections=[...this.directions]},250)}},computed:{lastYearTotal(){let t=0;for(let s of this.sales)t+=s.lastYearProfit;return this.formatCurrency(t)},thisYearTotal(){let t=0;for(let s of this.sales)t+=s.thisYearProfit;return this.formatCurrency(t)},ancho(){return 100/(this.indicadores[0].empresas.lenth+1)}},mounted(){this.loadData(this.getDirectionId()),this.loadDirections()}},P={class:"card"},V={class:"field"},x=e("label",{for:"directionId",class:"mb-3"},"Direcci\xF3n",-1),L={key:0},N={key:1},k={class:"p-datatable-wrapper"},A={key:0,class:"tabla"},F={class:""},T=e("th",{rowspan:"3"},[e("div",{class:""},[e("span",{class:"p-column-title"},"Indicadores")])],-1),U=["colspan"],E=e("div",{class:"p-column-header-content"},[e("span",{class:"p-column-title"}," Empresas")],-1),R=[E],Y={colspan:"2"},q={class:"p-column-header-content"},j={class:"p-column-title"},O=e("th",null,[e("div",{class:"p-column-header-content"},[e("span",{class:"p-column-title"},"Plan")])],-1),W=e("th",null,[e("div",{class:"p-column-header-content"},[e("span",{class:"p-column-title"},"Real")])],-1),z={class:""};function G(t,s,H,J,o,h){const y=g("AutoComplete"),p=g("ProgressSpinner");return n(),r("div",P,[e("div",V,[x,d(y,{placeholder:"Buscar direcci\xF3n",id:"directionId",dropdown:!0,modelValue:o.direction,"onUpdate:modelValue":s[0]||(s[0]=i=>o.direction=i),suggestions:o.autoFilteredDirections,onComplete:s[1]||(s[1]=i=>h.searchDirections(i)),"force-selection":!0,field:"name",onItemSelect:s[2]||(s[2]=i=>h.loadData(o.direction.id))},null,8,["modelValue","suggestions"])]),o.loading?(n(),r("div",L,[C(" cargando... "),d(p),d(p,{"aria-label":"Basic ProgressSpinner"})])):u("",!0),!o.indicadores||o.indicadores.length===0?(n(),r("div",N," No hay indicadores para esta direccion... ")):u("",!0),S(e("div",null,[e("div",k,[o.indicadores&&o.indicadores.length>0?(n(),r("table",A,[e("thead",F,[e("tr",null,[T,e("th",{colspan:2*o.indicadores[0].companies.length},R,8,U)]),e("tr",null,[(n(!0),r(l,null,a(o.indicadores[0].companies,i=>(n(),r("th",Y,[e("div",q,[e("span",j,c(i.name),1)])]))),256))]),e("tr",null,[(n(!0),r(l,null,a(o.indicadores[0].companies,i=>(n(),r(l,null,[O,W],64))),256))])]),e("tbody",z,[(n(!0),r(l,null,a(o.indicadores,i=>(n(),r("tr",null,[e("td",null,c(i.name),1),(n(!0),r(l,null,a(i.companies,_=>(n(),r(l,null,[e("td",null,c(_.planification),1),e("td",null,c(_.value),1)],64))),256))]))),256))])])):u("",!0)])],512),[[w,!o.loading]])])}const M=v(B,[["render",G]]);export{M as default};
